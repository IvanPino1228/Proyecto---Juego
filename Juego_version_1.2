<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ahorcado con Modos de Juego</title>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      text-align: center;
      background-color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    #palabra {
      font-size: 32px;
      letter-spacing: 10px;
      margin: 20px 0;
      color: #007acc;
    }
    #intentos, #temporizador {
      font-size: 18px;
      margin: 10px;
      color: #444;
    }
    #mensaje {
      font-size: 20px;
      font-weight: bold;
      margin: 15px;
    }
    canvas {
      background: #fff;
      border: 1px solid #ccc;
      margin: 20px auto;
      display: block;
    }
    #controles {
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #007acc;
      color: white;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #005f99;
    }
    select {
      padding: 8px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #999;
      margin-left: 10px;
    }
    #menuInicio {
      display: block;
    }
    #juego {
      display: none;
    }
  </style>
</head>
<body>
  <div id="menuInicio">
    <h1>üéÆ Elige el modo de juego</h1>
    <button onclick="iniciarJuego('individual')">üë§ Individual</button>
    <button onclick="iniciarJuego('multijugador')">üë• Multijugador</button>
    <button onclick="iniciarJuego('cronometrado')">‚è±Ô∏è Cronometrado</button>
  </div>

  <div id="juego">
    <h1>üéØ Juego del Ahorcado</h1>
    <canvas id="lienzo" width="300" height="300"></canvas>
    <div id="palabra"></div>
    <div id="intentos"></div>
    <div id="temporizador"></div>
    <div id="mensaje"></div>

    <div id="controles">
      <label for="dificultad">Dificultad:</label>
      <select id="dificultad">
        <option value="facil">F√°cil</option>
        <option value="medio" selected>Medio</option>
        <option value="dificil">Dif√≠cil</option>
      </select>
      <button onclick="nuevoJuego()">üîÑ Nuevo Juego</button>
      <button onclick="a√±adirPalabra()">‚ûï A√±adir palabra</button>
    </div>
  </div>

  <script>
    let palabras = [
      "SOL", "LUNA", "PYTHON", "PROGRAMACION", "JAVASCRIPT", 
      "AHORCADO", "INTELIGENCIA", "COMPUTADORA", "MICROPROCESADOR", "TECLADO"
    ];
    let palabraSecreta = "";
    let letrasAdivinadas = [];
    let intentos = 6;
    let palabraTemporal = null;
    let modoJuego = "individual";
    let temporizadorId = null;
    let tiempoRestante = 60;

    const palabraDiv = document.getElementById("palabra");
    const intentosDiv = document.getElementById("intentos");
    const mensajeDiv = document.getElementById("mensaje");
    const canvas = document.getElementById("lienzo");
    const ctx = canvas.getContext("2d");
    const menuInicio = document.getElementById("menuInicio");
    const juegoDiv = document.getElementById("juego");
    const temporizadorDiv = document.getElementById("temporizador");

    function iniciarJuego(modo) {
      modoJuego = modo;
      menuInicio.style.display = "none";
      juegoDiv.style.display = "block";

      if (modo === "multijugador") {
        let palabra = prompt("Jugador 2, escribe una palabra para adivinar:");
        if (palabra) {
          palabraTemporal = palabra.toUpperCase().replace(/[^A-Z√ë]/g, "");
        }
      }

      nuevoJuego();
    }

    function nuevoJuego() {
      const nivel = document.getElementById("dificultad").value;

      if (palabraTemporal) {
        palabraSecreta = palabraTemporal;
        palabraTemporal = null;
      } else {
        palabraSecreta = seleccionarPalabraPorNivel(nivel);
      }

      letrasAdivinadas = [];
      intentos = 6;
      mensajeDiv.textContent = "";
      tiempoRestante = 60;
      actualizarDisplay();
      dibujarBase();

      if (modoJuego === "cronometrado") {
        iniciarTemporizador();
      } else {
        detenerTemporizador();
        temporizadorDiv.textContent = "";
      }
    }

    function seleccionarPalabraPorNivel(nivel) {
      let filtradas = [];
      if (nivel === "facil") {
        filtradas = palabras.filter(p => p.length >= 3 && p.length <= 6);
      } else if (nivel === "medio") {
        filtradas = palabras.filter(p => p.length >= 7 && p.length <= 9);
      } else {
        filtradas = palabras.filter(p => p.length >= 10);
      }
      if (filtradas.length === 0) filtradas = palabras;
      return filtradas[Math.floor(Math.random() * filtradas.length)];
    }

    function actualizarDisplay() {
      const mostrar = palabraSecreta.split("").map(l => letrasAdivinadas.includes(l) ? l : "_").join(" ");
      palabraDiv.textContent = mostrar;
      intentosDiv.textContent = `Intentos restantes: ${intentos}`;
    }

    function verificar(letra) {
      if (letrasAdivinadas.includes(letra) || intentos <= 0) return;

      if (palabraSecreta.includes(letra)) {
        letrasAdivinadas.push(letra);
      } else {
        intentos--;
        dibujarAhorcado(6 - intentos);
      }

      actualizarDisplay();
      verificarFin();
    }

    function verificarFin() {
      if (palabraSecreta.split("").every(l => letrasAdivinadas.includes(l))) {
        mensajeDiv.textContent = "üéâ ¬°Ganaste!";
        detenerTemporizador();
      } else if (intentos === 0) {
        mensajeDiv.textContent = `üíÄ Perdiste. La palabra era: ${palabraSecreta}`;
        detenerTemporizador();
      }
    }

    function dibujarBase() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.lineWidth = 3;
      ctx.strokeStyle = "#000";
      ctx.beginPath();
      ctx.moveTo(50, 280);
      ctx.lineTo(250, 280);
      ctx.moveTo(100, 280);
      ctx.lineTo(100, 50);
      ctx.lineTo(200, 50);
      ctx.lineTo(200, 80);
      ctx.stroke();
    }

    function dibujarAhorcado(paso) {
      ctx.strokeStyle = "#000";
      switch(paso) {
        case 1: ctx.beginPath(); ctx.arc(200, 100, 20, 0, Math.PI * 2); ctx.stroke(); break;
        case 2: ctx.beginPath(); ctx.moveTo(200, 120); ctx.lineTo(200, 180); ctx.stroke(); break;
        case 3: ctx.beginPath(); ctx.moveTo(200, 140); ctx.lineTo(170, 160); ctx.stroke(); break;
        case 4: ctx.beginPath(); ctx.moveTo(200, 140); ctx.lineTo(230, 160); ctx.stroke(); break;
        case 5: ctx.beginPath(); ctx.moveTo(200, 180); ctx.lineTo(180, 220); ctx.stroke(); break;
        case 6: ctx.beginPath(); ctx.moveTo(200, 180); ctx.lineTo(220, 220); ctx.stroke(); break;
      }
    }

    function a√±adirPalabra() {
      let nueva = prompt("Escribe una nueva palabra para a√±adir al banco:") || "";
      nueva = nueva.toUpperCase().replace(/[^A-Z√ë]/g, "");
      if (nueva.length > 0) {
        palabras.push(nueva);
        alert(`‚úÖ Palabra "${nueva}" a√±adida al banco.`);
      } else {
        alert("‚ö†Ô∏è No se a√±adi√≥ ninguna palabra (solo letras v√°lidas).");
      }
    }

    function iniciarTemporizador() {
      detenerTemporizador();
      temporizadorId = setInterval(() => {
        tiempoRestante--;
        temporizadorDiv.textContent = `‚è±Ô∏è Tiempo restante: ${tiempoRestante}s`;
        if (tiempoRestante <= 0) {
          clearInterval(temporizadorId);
          mensajeDiv.textContent = `üíÄ ¬°Tiempo agotado! La palabra era: ${palabraSecreta}`;
        }
      }, 1000);
    }

    function detenerTemporizador() {
      if (temporizadorId) {
        clearInterval(temporizadorId);
        temporizadorId = null;
      }
    }

    document.addEventListener("keydown", (event) => {
      const letra = event.key.toUpperCase();
      if (/^[A-Z√ë]$/.test(letra)) {
        verificar(letra);
      }
    });
  </script>
</body>
</html>
